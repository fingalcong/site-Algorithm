<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>Betting Website</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Betting Website">
    <meta name="author" content="https://www.youtube.com/premierleague">    
    <link rel="shortcut icon" href="images/soccer_ball.jpg"> 
    
    <!-- FontAwesome CSS-->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
	<!-- Bootstrap CSS-->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">  
	<!-- Theme CSS -->
	<link rel="stylesheet" href="css/style.css">

</head> 

<body>
    
    <header class="header text-center">	    
	    <a class="site-title pt-lg-4 mb-0" href="index.html">Betting.com</a>
        
	    <nav class="navbar navbar-expand-lg navbar-dark" >
           
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
			</button>

			<div id="navigation" class="collapse navbar-collapse flex-column" >
				<img class="mb-3 mx-auto logo" src="images/soccer_ball.jpg" alt="logo" >			
				
				<ul class="navbar-nav flex-column text-sm-center text-md-left">
					<li class="nav-item">
					    <a class="nav-link" href="index.html"><i class="fas fa-home fa-fw mr-2"></i>Betting Home <span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
					    <a class="nav-link" href="post.html" onclick="return winorloss()"><i class="fas fa-file-alt fa-fw mr-2"></i>Betting games</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="bigsmall.html" onclick="return bigsmall()"><i class="fas fa-file-alt fa-fw mr-2"></i>Betting Big Small</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="corner.html" onclick="return corner()"><i class="fas fa-file-alt fa-fw mr-2"></i>Betting Corners</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="card.html" onclick="return card()"><i class="fas fa-file-alt fa-fw mr-2"></i>Betting Cards</a>
					</li>
					<li class="nav-item active">
						<a class="nav-link" href="page.html" id="purchase_history" onclick="return history()"><i class="fas fa-file-image fa-fw mr-2"></i>Purchase history</a>
					</li>
					<li class="nav-item">
					    <a class="nav-link" href="archive.html"><i class="fas fa-archive fa-fw mr-2"></i>About us</a>
					</li>
					<li class="nav-item">
					    <a class="nav-link btn btn-primary" href="contact.html"><i class="fas fa-envelope fa-fw mr-2"></i>Contact Us</a>
					</li>
					<li class="nav-item" id="login_page">
                        <a class="nav-link" id="login-page" href="login.html"><i class = "fas fa-envelope fa-fw mr-2"></i>Log In or Sign Up</a>
                    </li>
				</ul>
				<hr>
				<ul class="social-list list-inline py-3 mx-auto">
					<li class="list-inline-item"><a href="#"><i class="fab fa-twitter fa-fw"></i></a></li>
					<li class="list-inline-item"><a href="#"><i class="fab fa-linkedin-in fa-fw"></i></a></li>
					<li class="list-inline-item"><a href="#"><i class="fab fa-github-alt fa-fw"></i></a></li>
					<li class="list-inline-item"><a href="#"><i class="fab fa-stack-overflow fa-fw"></i></a></li>
					<li class="list-inline-item"><a href="#"><i class="fab fa-codepen fa-fw"></i></a></li>
				</ul>

			</div>
		</nav>
    </header>
    
    <div class="main-wrapper">
	    <header class="page-title theme-bg-light text-center gradient py-5">
			<h1 class="heading">Purchase History</h1>
		</header>
		<section class="theme-bg-dark py-5 text-center text-light">
			    <form class="signup-form form-inline justify-content-center pt-3">
                    <div class="form-group">
                        <label class="sr-only" for="semail">Your email</label>
                        <input type="email" id="semail" name="semail1" class="form-control mr-md-1 semail" placeholder="Enter email">
                    </div>
                    <button type="submit" class="btn btn-primary">Subscribe</button>
                </form>
	    </section>
	    <article class="about-section content px-3 py-5 p-md-5">
		    <div class="container">	
				<figure><img class="img-fluid" src="images/soccer betting_image.jpg" alt="image"></figure>		    
			    <h3 id="warning-message">Please log in first to check your own purchase history. </h3>
			    <!--<figure><img class="img-fluid" src="images/soccer betting_image.jpg" alt="image"></figure>-->
			    <h5 class="mt-5">Purchase History Table</h5>
				<h6 id="username-purchase">Alex</h6>
				<div>
					<table class="table table-striped my-5" id="purchase-table">
						<thead>
							<tr>
								<th scope="row">#</th>
								<td>Home Team</td>
								<td>Away Team</td>
								<td>Betting Type</td>
								<td>Subtype</td>
								<td>Amount</td>
								<td>Order Code</td>
							</tr>
						</thead>
						<tbody id="data_purchase_history">
							<!--add information automatically after getting data from back-end-->
						</tbody>
					</table>
				</div>    
		    </div>
	    </article>
	    
	    
	    
	    <footer class="footer text-center py-2 theme-bg-dark">
		   
            <p class="copyright"><a href="https://www.youtube.com/premierleague">FollowLeague</a></p>
		   
	    </footer>
    
    </div><!--//main-wrapper-->
    
    
    <!-- Bootstrap Javascript -->          
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<script src="js/main.js"></script>
	<script>
		const jwtoken = document.cookie.match(/jwt=([^;]+)/);
		const result = document.cookie.match(/authorization=(\w+)/);
		const access = document.cookie.match(/access=(\w+)/);
		//let len = 0;
		
		var xhr = new XMLHttpRequest();
    	xhr.onreadystatechange = function() {
			if (xhr.readyState == XMLHttpRequest.DONE) {
				//alert(xhr.status)//200, 403
				if(result[1] == "success" && access[1] == 'success'){
					var text = document.getElementById('warning-message');
					text.innerText = "Successfully Log in";
					text.style.color = "green";

					var username = document.getElementById('username-purchase');
					username.innerText = "Email: " + JSON.parse(xhr.response)[0].email;
					username.style.color = "blue";

					const len = JSON.parse(xhr.response).length;
					//data = JSON.parse(xhr.response)[0].id;

					for(let i = 0; i < len; i++){
						var tbody = document.querySelector('#data_purchase_history');
						var tr = document.createElement('tr');
						var td0 = document.createElement('td');
						var td1 = document.createElement('td');
						var td2 = document.createElement('td');
						var td3 = document.createElement('td');
						var td4 = document.createElement('td');
						var td5 = document.createElement('td');
						var td6 = document.createElement('td');

						td0.innerHTML = i + 1;
						td1.innerHTML = JSON.parse(xhr.response)[i].homeTeam;
						td2.innerHTML = JSON.parse(xhr.response)[i].awayTeam;
						td3.innerHTML = JSON.parse(xhr.response)[i].type;
						td4.innerHTML = JSON.parse(xhr.response)[i].subType;
						td5.innerHTML = JSON.parse(xhr.response)[i].amount;
						td6.innerHTML = JSON.parse(xhr.response)[i].id;

						tr.append(td0);
						tr.append(td1);
						tr.append(td2);
						tr.append(td3);
						tr.append(td4);
						tr.append(td5);
						tr.append(td6);
						tbody.append(tr);
					}

					/*var tbody = document.querySelector('#data_purchase_history');
					var tr = document.createElement('tr');
					var td0 = document.createElement('td');
					var td1 = document.createElement('td');
					var td2 = document.createElement('td');
					var td3 = document.createElement('td');
					var td4 = document.createElement('td');
					var td5 = document.createElement('td');
					var td6 = document.createElement('td');

					td0.innerHTML = '1'; //change this num to a count when utilizing later
					td1.innerHTML = 'Arsenal';
					td2.innerHTML = 'Liverpool';
					td3.innerHTML = 'Big or Small';
					td4.innerHTML = 'Big';
					td5.innerHTML = '50000';
					td6.innerHTML = 'UCI MCS';

					tr.append(td0);
					tr.append(td1);
					tr.append(td2);
					tr.append(td3);
					tr.append(td4);
					tr.append(td5);
					tr.append(td6);
					tbody.append(tr);*/
				}
				//alert(data);
			}
    	}
		var url = "http://localhost:8080/api/v1/order/MyOrder";
		xhr.open("GET", url, true);
		xhr.setRequestHeader('Authorization', 'Bearer ' + jwtoken[1]);
		//xhr.setRequestHeader("Content-Type", "application/json");
		xhr.send();
	</script> 

</body>
</html> 

